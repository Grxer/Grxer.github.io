<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="baidu-site-verification" content="codeva-ROfYcqLkCh" />
    <meta name="msvalidate.01" content="ECA3E06A0E52A2AC90C4B06F12981FB2" />
    <meta name="description" content="Linux对异常的处理陷入内核调用异常处理程序，对于故障(Fault)  如果处理程序可以修复的故障，比如正常的缺页，修复后回到断点处继续执行  如果不能修复的，比如越级，越权，越界，除0等，linux只会给进程发送一个信号，回到用户态，进程去调度相应的信号处理程序，这样做是快速在内核态完成异常处理，减小嵌套执行异常的可能性   linux里可以用kill -l查看信号列表，编号为1 ~ 31的信">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 信号(Signal)">
<meta property="og:url" content="https://grxer.gitee.io/2023/04/24/linux-signal/index.html">
<meta property="og:site_name" content="Grxer&#39;s Blog">
<meta property="og:description" content="Linux对异常的处理陷入内核调用异常处理程序，对于故障(Fault)  如果处理程序可以修复的故障，比如正常的缺页，修复后回到断点处继续执行  如果不能修复的，比如越级，越权，越界，除0等，linux只会给进程发送一个信号，回到用户态，进程去调度相应的信号处理程序，这样做是快速在内核态完成异常处理，减小嵌套执行异常的可能性   linux里可以用kill -l查看信号列表，编号为1 ~ 31的信">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-04-24T03:16:22.000Z">
<meta property="article:modified_time" content="2023-09-10T08:25:27.364Z">
<meta property="article:author" content="bxz">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Linux 信号(Signal)</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 lrt">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/04/28/static-link/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/04/23/floating-point-calculation-and-kahan/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://grxer.gitee.io/2023/04/24/linux-signal/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://grxer.gitee.io/2023/04/24/linux-signal/&text=Linux 信号(Signal)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://grxer.gitee.io/2023/04/24/linux-signal/&is_video=false&description=Linux 信号(Signal)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Linux 信号(Signal)&body=Check out this article: https://grxer.gitee.io/2023/04/24/linux-signal/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://grxer.gitee.io/2023/04/24/linux-signal/&name=Linux 信号(Signal)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://grxer.gitee.io/2023/04/24/linux-signal/&t=Linux 信号(Signal)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E5%AF%B9%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Linux对异常的处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E4%BF%A1%E5%8F%B7"><span class="toc-number">2.</span> <span class="toc-text">发送信号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%8F%97%E4%BF%A1%E5%8F%B7"><span class="toc-number">3.</span> <span class="toc-text">接受信号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%92%8C%E4%BF%A1%E5%8F%B7%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.</span> <span class="toc-text">修改和信号相关联的默认行为</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%9C%AC%E5%9C%B0%E8%B7%B3%E8%BD%AC"><span class="toc-number">4.1.</span> <span class="toc-text">非本地跳转</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Linux 信号(Signal)
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">bxz</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-24T03:16:22.000Z" itemprop="datePublished">2023-04-24</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Linux对异常的处理"><a href="#Linux对异常的处理" class="headerlink" title="Linux对异常的处理"></a>Linux对异常的处理</h2><p>陷入内核调用异常处理程序，对于故障(Fault)</p>
<ul>
<li><p>如果处理程序可以修复的故障，比如正常的缺页，修复后回到断点处继续执行</p>
</li>
<li><p>如果不能修复的，比如越级，越权，越界，除0等，linux只会给进程发送一个信号，回到用户态，进程去调度相应的信号处理程序，这样做是快速在内核态完成异常处理，减小嵌套执行异常的可能性</p>
</li>
</ul>
<p>linux里可以用kill -l查看信号列表，编号为1 ~ 31的信号为传统UNIX支持的信号，是不可靠信号(非实时的)，编号为32 ~ 63的信号是后来扩充的，称做可靠信号(实时信号)。不可靠信号和可靠信号的区别在于前者不支持排队，可能会造成信号丢失，而后者不会。</p>
<table>
<thead>
<tr>
<th>信号值</th>
<th>信号名称</th>
<th>说明</th>
<th>默认行为</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><code>SIGHUP</code></td>
<td>终端断开连接</td>
<td>终止进程</td>
</tr>
<tr>
<td>2</td>
<td><code>SIGINT</code></td>
<td>终端中断符（Ctrl+C）</td>
<td>终止进程</td>
</tr>
<tr>
<td>3</td>
<td><code>SIGQUIT</code></td>
<td>终端退出符（Ctrl+\）</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>4</td>
<td><code>SIGILL</code></td>
<td>非法指令</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>5</td>
<td><code>SIGTRAP</code></td>
<td>跟踪断点</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>6</td>
<td><code>SIGABRT</code></td>
<td>异常终止</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>7</td>
<td><code>SIGBUS</code></td>
<td>总线错误</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>8</td>
<td><code>SIGFPE</code></td>
<td>浮点异常</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>9</td>
<td><code>SIGKILL</code></td>
<td>无条件终止</td>
<td>终止进程</td>
</tr>
<tr>
<td>10</td>
<td><code>SIGUSR1</code></td>
<td>用户定义信号1</td>
<td>终止进程</td>
</tr>
<tr>
<td>11</td>
<td><code>SIGSEGV</code></td>
<td>段错误</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>12</td>
<td><code>SIGUSR2</code></td>
<td>用户定义信号2</td>
<td>终止进程</td>
</tr>
<tr>
<td>13</td>
<td><code>SIGPIPE</code></td>
<td>写入管道或套接字时，读取端已关闭</td>
<td>终止进程</td>
</tr>
<tr>
<td>14</td>
<td><code>SIGALRM</code></td>
<td>定时器信号</td>
<td>终止进程</td>
</tr>
<tr>
<td>15</td>
<td><code>SIGTERM</code></td>
<td>终止请求</td>
<td>终止进程</td>
</tr>
<tr>
<td>16</td>
<td><code>SIGSTKFLT</code></td>
<td>协处理器堆栈错误</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>17</td>
<td><code>SIGCHLD</code></td>
<td>子进程状态变化</td>
<td>忽略信号</td>
</tr>
<tr>
<td>18</td>
<td><code>SIGCONT</code></td>
<td>继续执行停止的进程</td>
<td>忽略信号</td>
</tr>
<tr>
<td>19</td>
<td><code>SIGSTOP</code></td>
<td>停止进程，不能被捕捉或忽略</td>
<td>停止进程</td>
</tr>
<tr>
<td>20</td>
<td><code>SIGTSTP</code></td>
<td>终端停止符（Ctrl+Z）</td>
<td>停止进程</td>
</tr>
<tr>
<td>21</td>
<td><code>SIGTTIN</code></td>
<td>后台进程试图从终端读取</td>
<td>停止进程</td>
</tr>
<tr>
<td>22</td>
<td><code>SIGTTOU</code></td>
<td>后台进程试图向终端写入</td>
<td>停止进程</td>
</tr>
<tr>
<td>23</td>
<td><code>SIGURG</code></td>
<td>套接字上接收到紧急数据</td>
<td>忽略信号</td>
</tr>
<tr>
<td>24</td>
<td><code>SIGXCPU</code></td>
<td>CPU时间限制超时</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>25</td>
<td><code>SIGXFSZ</code></td>
<td>文件大小限制超时</td>
<td>生成core文件并终止进程</td>
</tr>
<tr>
<td>26</td>
<td><code>SIGVTALRM</code></td>
<td>虚拟定时器信号</td>
<td>终止进程</td>
</tr>
<tr>
<td>27</td>
<td><code>SIGPROF</code></td>
<td>分时定时器信号</td>
<td>终止进程</td>
</tr>
<tr>
<td>28</td>
<td><code>SIGWINCH</code></td>
<td>窗口大小变化</td>
<td>忽略信号</td>
</tr>
<tr>
<td>29</td>
<td><code>SIGIO</code></td>
<td>异步I&#x2F;O事件</td>
<td>忽略信号</td>
</tr>
<tr>
<td>30</td>
<td>SIGPWR</td>
<td>电源故障</td>
<td>终止</td>
</tr>
<tr>
<td>31</td>
<td>SIGSYS</td>
<td>非法系统调用</td>
<td>终止</td>
</tr>
</tbody></table>
<p>这种信号机制，给了用户一种进程间通信机制，自定义信号处理程序的权力</p>
<p>linux 1 ~ 31里一种类型的信号最多只有一个待处理信号(一个发出而没有被接收处理的信号叫做待处理信号)，因为传统UNIX支持的信号是用bitflag实现的，已经置1再置1也没意思，这也是为什么叫不可靠信号的原因，后面序号的可靠信号都是通过队列来实现</p>
<h2 id="发送信号"><a href="#发送信号" class="headerlink" title="发送信号"></a>发送信号</h2><ol>
<li><p>内核的异常处理程序</p>
</li>
<li><p>&#x2F;bin&#x2F;kill发送</p>
</li>
</ol>
<blockquote>
<p>&#x2F;bin&#x2F;kill -signalid pid</p>
<p>pid为正数给pid进程 发送signalid信号</p>
<p>pid为负数给pid<strong>进程组</strong>所有进程发送signalid信号</p>
</blockquote>
<ol start="3">
<li>键盘发送信号 ctrl c ctrl z等</li>
<li>kill函数显式地要求内核发送一个信号给目的进程。</li>
</ol>
<blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">kill</span><span class="params">(<span class="type">pid_t</span> pid, <span class="type">int</span> sig)</span>;</span><br><span class="line">成功返回<span class="number">0</span> 否则返回<span class="number">-1</span>;</span><br><span class="line">pid &gt;<span class="number">0</span> 发送sig给进程pid;</span><br><span class="line">pid =<span class="number">0</span> 发送sig给调用进程所在进程组的每一个进程(包括自己);</span><br><span class="line">pid &lt;<span class="number">0</span> 发送sig给|pid|进程组的每一个进程</span><br></pre></td></tr></table></figure>
</blockquote>
<ol start="5">
<li>alarm函数</li>
</ol>
<blockquote>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">alarm</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> secs)</span>;</span><br><span class="line">在secs秒后    发送一个SIGALRM信号给调用进程 secs为<span class="number">0</span>不会调度安排新闹钟，任何情况下都会取消待处理(pending)的闹钟，返回剩余秒数，没有待处理的闹钟返回<span class="number">0</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="接受信号"><a href="#接受信号" class="headerlink" title="接受信号"></a>接受信号</h2><p>隐式阻塞机制</p>
<blockquote>
<p>内核默认阻塞任何当前处理程序正在处理信号类型的待处理的信号。也就是信号处理程序执行时不接受正在处理类型的信号</p>
</blockquote>
<p>显示阻塞机制</p>
<blockquote>
<p>应用程序可以使用 sigprocmask 函数和它的辅助函数，来设置信号屏蔽字，明确地阻塞和解除阻塞选定的信号。<strong>SIGKILL 和 SIGSTOP 不能被阻塞</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sigprocmask</span><span class="params">(<span class="type">int</span> how, <span class="type">const</span> <span class="type">sigset_t</span> *<span class="built_in">set</span>, <span class="type">sigset_t</span> *oldset)</span>;</span><br><span class="line">how 值：</span><br><span class="line">SIG_BLOCK:把<span class="built_in">set</span>里信号添加到blocked列表</span><br><span class="line">SIG_UNBLOCK:从blocked里删除<span class="built_in">set</span>里的信号</span><br><span class="line">SIG_SETMASK:block=<span class="built_in">set</span></span><br><span class="line">把旧的blocked保存到oldset</span><br><span class="line"><span class="built_in">set</span> 为<span class="literal">NULL</span>，读取现在的屏蔽值</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sigemptyset(<span class="type">sigset_t</span> *<span class="built_in">set</span>);</span><br><span class="line">初始化<span class="built_in">set</span>为<span class="number">0</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sigfillset</span><span class="params">(<span class="type">sigset_t</span> *<span class="built_in">set</span>)</span>;</span><br><span class="line">所有信号填入<span class="built_in">set</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">sigaddset</span><span class="params">(<span class="type">sigset_t</span> *<span class="built_in">set</span>, <span class="type">int</span> signum)</span>;</span><br><span class="line">填入signum</span><br><span class="line"><span class="type">int</span> <span class="title function_">sigdelset</span><span class="params">(<span class="type">sigset_t</span> *<span class="built_in">set</span>, <span class="type">int</span> signum)</span>;</span><br><span class="line">删除signum</span><br><span class="line">返回：如果成功则为 o, 若出错则为<span class="number">-1</span> 。</span><br><span class="line"><span class="type">int</span> <span class="title function_">sigismember</span><span class="params">(<span class="type">const</span> <span class="type">sigset_t</span> *<span class="built_in">set</span>, <span class="type">int</span> signum)</span>;</span><br><span class="line">返回：若 signum 是 <span class="built_in">set</span> 的成员则为 <span class="number">1</span>, 如果不是则为 <span class="number">0</span> 若出错则为<span class="number">-1</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>显示阻塞并不是被直接丢弃了，在恢复阻塞后，还可以接收到</p>
<h2 id="修改和信号相关联的默认行为"><a href="#修改和信号相关联的默认行为" class="headerlink" title="修改和信号相关联的默认行为"></a>修改和信号相关联的默认行为</h2><p>IGSTOP和SIGKILL不能修改</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="title function_">void</span> <span class="params">(*<span class="type">sighandler_t</span>)</span><span class="params">(<span class="type">int</span>)</span>;</span><br><span class="line"><span class="type">sighandler_t</span> <span class="title function_">signal</span><span class="params">(<span class="type">int</span> signum, <span class="type">sighandler_t</span> handler)</span>;</span><br><span class="line">返回：若成功则为指向前次处理程序的指针，若出错则为SIG_ERRC不设置errno);</span><br><span class="line">handler 是SIG_IGN 忽略signum该类型信号;</span><br><span class="line">handler 是SIG_DFL signum恢复默认行为;</span><br><span class="line">handler 是个函数地址 设置该函数为异常处理函数</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_handler</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ctrl c&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">__sighandler_t</span> rs = signal(SIGINT, signal_handler);</span><br><span class="line">    assert(rs != SIG_ERR);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; gcc -g -O2 -o test test.c</span><br><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^Cctrl c</span><br><span class="line">^Cctrl c</span><br><span class="line">^Cctrl c</span><br><span class="line">^Cctrl c</span><br><span class="line">^Cctrl c</span><br></pre></td></tr></table></figure>

<p>处理程序结束后会返回到断点处继续</p>
<p>阻塞掉SIGINT信号</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_handler</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ctrl c&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">sigset_t</span> mask;</span><br><span class="line">    sigemptyset(&amp;mask);</span><br><span class="line">    sigaddset(&amp;mask, SIGINT);</span><br><span class="line">    sigprocmask(SIG_BLOCK,&amp;mask,<span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">__sighandler_t</span> rs = signal(SIGINT, signal_handler);</span><br><span class="line">    assert(rs != SIG_ERR);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; gcc -g -O2 -o test test.c</span><br><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^C^Z</span><br><span class="line">fish: Job 6, &#x27;./test&#x27; has stopped</span><br></pre></td></tr></table></figure>

<h3 id="非本地跳转"><a href="#非本地跳转" class="headerlink" title="非本地跳转"></a>非本地跳转</h3><p>整数除0会SIGFPE</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">fish: Job 1, &#x27;./test&#x27; terminated by signal SIGFPE (Floating point exception)</span><br></pre></td></tr></table></figure>

<p>本来想着改掉SIGFPE的默认处理，看看整数除0后结果是什么样</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_handler</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">__sighandler_t</span> rs = signal(SIGFPE, signal_handler);</span><br><span class="line">    assert(rs != SIG_ERR);</span><br><span class="line">    <span class="type">int</span> z = <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    z = z / t;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果忘了信号处理函数过后会返回到断点处，也就是导致这个异常的语句处z &#x3D; z &#x2F; t;然后就会一直导致SIGFPE，goto只能实现函数内的跳转，其实goto在汇编层就是一个无条件的跳转jmp，他也没能力实现函数间的跳转，除非他能把栈给平了，寄存器修正了</p>
<p>使用setjmp就可以做到</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">setjmp</span><span class="params">(jmp_buf env)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">sigsetjmp</span><span class="params">(sigjmp_buf env, <span class="type">int</span> savesigs)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">longjmp</span><span class="params">(jmp_buf env, <span class="type">int</span> val)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">siglongjmp</span><span class="params">(sigjmp_buf env, <span class="type">int</span> val)</span>;</span><br></pre></td></tr></table></figure>

<p>setjmp把当前程序各种信息保存到env里(typically, the stack pointer, the instruction pointer,  possibly  the  values  of other registers and the signal mask),直接调用返回0，</p>
<p>longjmp利用最近一次保存的env来恢复之前的环境，成功调用后不返回，原来的setjmp会再次返回第二个参数val的值</p>
<p>sigsetjmp和setjmp差不多只是，sigsetjmp只要第二个参数不为0就会保存信号屏蔽字，jmp过来时恢复，sigset不会</p>
<p>手册原话</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">sigsetjmp() and <span class="title function_">siglongjmp</span><span class="params">()</span></span><br><span class="line">       <span class="title function_">sigsetjmp</span><span class="params">()</span>  and  <span class="title function_">siglongjmp</span><span class="params">()</span> also perform nonlocal gotos, but provide</span><br><span class="line">       predictable handling of the process signal mask.</span><br><span class="line"></span><br><span class="line">       If, and only <span class="keyword">if</span>, the savesigs argument provided to <span class="title function_">sigsetjmp</span><span class="params">()</span> is  non‐</span><br><span class="line">       zero, the process&#x27;s current signal mask is saved in env and will be re‐</span><br><span class="line">       stored <span class="keyword">if</span> a <span class="title function_">siglongjmp</span><span class="params">()</span> is later performed with this env.</span><br></pre></td></tr></table></figure>

<p>sigpending()用于获取当前进程已经被阻塞但尚未处理的信号集合</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">jmp_buf env;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">sigset_t</span> mask, pendmask, blockmask;</span><br><span class="line">    sigemptyset(&amp;mask);</span><br><span class="line">    sigemptyset(&amp;pendmask);</span><br><span class="line">    sigemptyset(&amp;blockmask);</span><br><span class="line">    sigaddset(&amp;mask, SIGINT);</span><br><span class="line">    sigprocmask(SIG_BLOCK, &amp;mask, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">// if (sigsetjmp(env, 666) != 0) &#123;</span></span><br><span class="line">        <span class="keyword">if</span> (setjmp(env) != <span class="number">0</span>) &#123;</span><br><span class="line">        sigpending(&amp;pendmask);</span><br><span class="line">        sigprocmask(SIG_BLOCK, <span class="literal">NULL</span>, &amp;blockmask);</span><br><span class="line">        <span class="keyword">if</span> (sigismember(&amp;blockmask, SIGINT))</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;in blockmask&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;not in blockmask&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (sigismember(&amp;pendmask, SIGINT))</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;in pendmask&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;not in pendmask&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sleep(<span class="number">2</span>);<span class="comment">//时间间隔我疯狂按ctrl c :)</span></span><br><span class="line">    <span class="comment">// siglongjmp(env, 1);</span></span><br><span class="line">    longjmp(env, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用sigsetjmp时</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^C^C^C^Cin blockmask</span><br><span class="line">in pendmask</span><br></pre></td></tr></table></figure>

<p>使用setjmp</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^C^C^C^Cin blockmask</span><br><span class="line">in pendmask</span><br></pre></td></tr></table></figure>

<p>WTF 看来是我之前理解错了，他们都不会清除当前的信号屏蔽字和已经被阻塞但尚未处理的信号集合</p>
<p>gdb看下</p>
<p>setjmp(env) !&#x3D; 0</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; p/x env</span><br><span class="line">$<span class="number">2</span> = &#123;&#123;</span><br><span class="line">    __jmpbuf = &#123;<span class="number">0x0</span>, <span class="number">0xfa3c37809f472823</span>, <span class="number">0x7fffffffdfd8</span>, <span class="number">0x555555555269</span>, <span class="number">0x555555557d78</span>, <span class="number">0x7ffff7ffd040</span>, <span class="number">0xfa3c378098a72823</span>, <span class="number">0xaf6962d587272823</span>&#125;,</span><br><span class="line">    __mask_was_saved = <span class="number">0x0</span>,</span><br><span class="line">    __saved_mask = &#123;</span><br><span class="line">      __val = &#123;<span class="number">0x0</span> &lt;repeats <span class="number">16</span> times&gt;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>sigsetjmp(env, 666) !&#x3D; 0</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; p/x env</span><br><span class="line">$<span class="number">2</span> = &#123;&#123;</span><br><span class="line">    __jmpbuf = &#123;<span class="number">0x0</span>, <span class="number">0x6cdae548d2b8f980</span>, <span class="number">0x7fffffffdfd8</span>, <span class="number">0x555555555269</span>, <span class="number">0x555555557d78</span>, <span class="number">0x7ffff7ffd040</span>, <span class="number">0x6cdae548d558f980</span>, <span class="number">0x398fb01dcad2f980</span>&#125;,</span><br><span class="line">    __mask_was_saved = <span class="number">0x1</span>,</span><br><span class="line">    __saved_mask = &#123;</span><br><span class="line">      __val = &#123;<span class="number">0x2</span>, <span class="number">0x0</span> &lt;repeats <span class="number">15</span> times&gt;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>sigsetjmp确实保存了signal mask</p>
<p>那应该就是sigsetjmp最后会比setjmp多一个恢复过程</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">jmp_buf env;</span><br><span class="line"><span class="type">sigset_t</span> mask, pendmask, blockmask;</span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_handler</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nctrl+\\\n&quot;</span>);</span><br><span class="line">    siglongjmp(env, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// longjmp(env, 1);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    assert(sigemptyset(&amp;mask)==<span class="number">0</span>);</span><br><span class="line">    sigemptyset(&amp;pendmask);</span><br><span class="line">    sigemptyset(&amp;blockmask);</span><br><span class="line">    sigaddset(&amp;mask, SIGINT);</span><br><span class="line">    sigprocmask(SIG_BLOCK, &amp;mask, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="type">__sighandler_t</span> rs = signal(SIGQUIT, signal_handler);<span class="comment">/*ctrl+\*/</span></span><br><span class="line">    assert(rs != SIG_ERR);</span><br><span class="line">    <span class="keyword">if</span> (sigsetjmp(env, <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// if (setjmp(env) != 0) &#123;</span></span><br><span class="line">        sigpending(&amp;pendmask);</span><br><span class="line">        sigprocmask(SIG_BLOCK, <span class="literal">NULL</span>, &amp;blockmask);</span><br><span class="line">        <span class="keyword">if</span> (sigismember(&amp;blockmask, SIGINT))</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;in blockmask&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;not in blockmask&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">        sigprocmask(SIG_UNBLOCK, &amp;mask, <span class="literal">NULL</span>);<span class="comment">//取消阻塞</span></span><br><span class="line">    sleep(<span class="number">2</span>);<span class="comment">/*按下ctrl+\*/</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sigsetjmp时</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^\</span><br><span class="line">ctrl+\</span><br><span class="line">in blockmask</span><br></pre></td></tr></table></figure>

<p>setjmp时</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">^\</span><br><span class="line">ctrl+\</span><br><span class="line">not in blockmask</span><br></pre></td></tr></table></figure>

<p>是这个意思了，这么简单的东西刚开始居然理解错了，艹</p>
<p>完成一下最初想做的事</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;signal.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;assert.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;setjmp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">jmp_buf env;</span><br><span class="line"><span class="type">void</span> <span class="title function_">signal_handler</span><span class="params">(<span class="type">int</span> sig)</span> &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">    siglongjmp(env, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">__sighandler_t</span> rs = signal(SIGFPE, signal_handler);</span><br><span class="line">    assert(rs != SIG_ERR);</span><br><span class="line">    <span class="type">int</span> z = <span class="number">12</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (sigsetjmp(env, <span class="number">1</span>) ==<span class="number">0</span> ) &#123;</span><br><span class="line">        z = z / t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, z); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">grxer@Ubuntu22-wsl ~/s/test&gt; ./test</span><br><span class="line">xxx</span><br><span class="line">12</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux%E5%AF%B9%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Linux对异常的处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E4%BF%A1%E5%8F%B7"><span class="toc-number">2.</span> <span class="toc-text">发送信号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%8F%97%E4%BF%A1%E5%8F%B7"><span class="toc-number">3.</span> <span class="toc-text">接受信号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%92%8C%E4%BF%A1%E5%8F%B7%E7%9B%B8%E5%85%B3%E8%81%94%E7%9A%84%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.</span> <span class="toc-text">修改和信号相关联的默认行为</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%9C%AC%E5%9C%B0%E8%B7%B3%E8%BD%AC"><span class="toc-number">4.1.</span> <span class="toc-text">非本地跳转</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://grxer.gitee.io/2023/04/24/linux-signal/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://grxer.gitee.io/2023/04/24/linux-signal/&text=Linux 信号(Signal)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://grxer.gitee.io/2023/04/24/linux-signal/&is_video=false&description=Linux 信号(Signal)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Linux 信号(Signal)&body=Check out this article: https://grxer.gitee.io/2023/04/24/linux-signal/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://grxer.gitee.io/2023/04/24/linux-signal/&title=Linux 信号(Signal)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://grxer.gitee.io/2023/04/24/linux-signal/&name=Linux 信号(Signal)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://grxer.gitee.io/2023/04/24/linux-signal/&t=Linux 信号(Signal)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2025
    bxz
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?a22ef0bec4e4a9c7337bea6e37ff55c1";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
